# 第 一 章  绪论
##  1.1 医学影像技术概述&emsp; 
&emsp;&emsp;医学是一门关系到每个人身心健康的应用科学，它的发展水平不仅体现了一个国家人民的生活标准，而且代表了一个国家的综合国力。而医学影像的出现和发展极大地促进了医学的发展，医学影像的发展，在某种意义上，代表了医学未来的发展和前进方向。所谓医学影像是指为了医疗或医学研究，对人体或人体某部分，以非入侵方式取得内部组织影像的技术与处理过程，是一种逆问题的推论演算，即成因（活体组织的特性）是经由结果（观测影像信号）反推而来。1985年X射线的发现，开启了医学影像崭新的一页，使得传统的医疗诊断方式发生了翻天覆地的变化。此后一段时间里，各种基于X线成像的基本技术和设备被不断研究出来，在其他医学影像手段出现之前的半个多世纪里，它一直是唯一的临床影像直观检查方法。由于这种常规X射线成像技术是将三维人体结构显示在二维平面上，加之其对软组织的成像能力较差，使整个成像系统的性能受到限制。同时，传统X线成像设备的辐射剂量较大，对患者和医务人员的身体健康有着较大危害。

&emsp;&emsp;医用超声技术和核医学的出现使基于X线成像的诊断系统发生了革命性的变化。它们不但克服X线成像的局限性，而且提供了无创伤地显示疾病的新手段。超声成像具有安全、成像速度快、价格便宜和使用方便等优点，可实现连续动态及重复扫描，非常适合于心脏、大血管及胆囊的显示和测量。超声成像容易受到气体和骨骼的阻碍，不适合含气脏器如肺、消化道及骨骼的检查，同时超声诊断的准确性受操作者的经验、检查技巧和认真程度的影响。所谓的影像核医学是指将放射性核素及其标记化合物引入体内，实现脏器、组织、病变的功能性显像方法，也称放射性核素显像。核医学显像具有简单、灵敏、特异、无创伤、安全和易于重复等特点。核医学在心脏缺血、脑血流灌注减低以及其它器官的功能例如甲状腺、肾脏、肝脏和肺诊断中有很大优势。

&emsp;&emsp;20世纪70年代初，随着X线计算机断层成像设备（CT）的出现，医学影像技术呈现出崭新的面貌。CT显著地改善了X线的检查的分辨能力，其分辨率和定性诊断准确率大大高于一般X线机。和传统X线影像相比，CT使用计算机处理探测器所得到的资料，能够区别差异极小的X线吸收值，这使得CT不仅能区分脂肪与其他软组织，还能分辨软组织的密度等级。除此之外，CT还具有检查速度快，尤其适合于急诊患者的检查，如外伤、脑血管意外等。这种革命性技术显著地改变了许多疾病的诊断方式。在CT出现以前，医院里使用得最多的常规X线机基本上是模拟方式的，输出模拟信号，这样只能用胶片进行记录。这使得X线图像的处理、存储和传输都受到极大的限制，医生无法充分利用这些信息，与其他影像方法的结果对照和融合也很困难。1972年CT出现后，80年代所有的影像诊断技术领域均向数值化急速发展，几乎所有的医学影像设备均实现了用计算机存储图像。

1946年斯坦福大学的Flexible Bloch和哈佛大学的Edward Purcell各自独立地发现了核磁共振现象。经过短短几十年的发展，第一台医用核磁共振成像设备仪于20世纪80年代问世。MRI能够利用各种参数来成像，多个成像参数能提供丰富的诊断信息，同时由于MRI不同于已有的成像技术，因此对疾病的诊断具有更大的潜在优越性。MRI可以直接做出横断面、矢状面、冠状面和各种斜面的断层图像，不会产生CT检测中的伪影；无电离辐射，不会对机体产生不良影响；与CT相比对软组织具有更高的分辨力和更高的空间分辨率等优点。MRI对检测脑内血肿、脑外血肿、脑肿瘤等颅脑常见疾病非常有效，同时对腰椎椎间盘后突、原发性肝癌等疾病的诊断也很有效。目前，该项技术还正处于积极发展和完善阶段。

随后，各种先进的医学影像技术不断出现，各种成像技术获得信息的互补，为临床医疗诊断及生物医学研究提供了有力的武器。随着现代计算机技术的发展以及随之兴起的各种图像处理技术，在医学领域，各种先进的计算机技术和图像处理技术得到了广泛的应用，能够有效地辅助医生对医学图像进行定性或定量的分析，成为促进医疗水平提高必不可少的手段。使用计算机对医学影像设备采集到的图像进行处理这一技术被称为医学影像处理与分析，它可以辅助医生进行更好、更准确的诊断，使诊断水平大大提升。目前在医学图像处理方面使用到的图像处理与分析技术主要有三种，它们分别为：医学图像分割，医学图像配准和医学图像三维重建。
    
医学图像的分割是指按照一定的原则将一副医学图像分为若干个特定的、具有独特性质的部分或子集，并提取出感兴趣的目标的技术和过程，其主要目的是将医学影像中感兴趣的物体（一般是病灶区）提取出来。医学图像分割是对医学图像进行进一步分析和处理的基础，也是图像处理中的关键技术，所以医学图像分割是医学图像分析与处理中的重要部分。医学图像的分割是病变区域提取、特定组织测量的手段，同时也是可视化实现的与处理步骤和前提。医学图像分割理论和方法至今尚未获得圆满的解决，一直是一个非常活跃的研究课题，吸引着很多研究人员去探索这个问题。

医学图像的配准是指对于不同模态的医学图像（如MRI，CT，PET等），利用计算机技术实现对于一副医学图像寻求一种或者一系列的空间变换，使它与另一幅医学图像上的对应点达到空间上的一致。各种医学影像技术获得的医学影像信息都有它的优势与不足，它们相辅相成、相互补充。要想提高诊断正确率，就需要综合利用患者的各种图像信息。目前医学影像的一个显著发展趋势是，利用信息融合技术，将不同影像技术获得的医学图像结合起来。这样能够充分利用不同医学图像的特点，在一幅图像上同时表达来自人体的多方面的信息，使人体内部的结构、功能等多方面的状况通过影像反映出来，从而更加直观的提供人体解剖、生理及疾病等信息。要解决医学图像信息融合问题，首先要解决医学图像配准问题，即多付医学图像在空间域中达到几何位置的完全对应，医学图像配准同时也是医学图像三维重建与可视化的先决条件。

医学图像三维重建是医学影像处理与分析的重要手段之一，其是指利用医学影像设备获取图像数据，通过面绘制或体绘制等可视化图像绘制算法，得到所有视角的透视三维立体图像的技术。以前，使用CT、MRI、B超和电子内窥镜等设备可以很方便地获得相应的影像数据，为医学诊断提供了大量的参考信息，成为临床诊断的重要工具。虽然这些数据为医生的诊断提供了方便，但是这些信息都是二维的，只能提供某一剖面的解剖信息。医生只能以固定方式对这些二维影像进行观察，不能最大限度地帮助医生进行诊断。医生在诊断时不得不根据自己的经验来判断病灶的大小和形状，这就使得诊断结果缺乏客观性和准确性。因此最好能在医生观察影像前有针对性的对影像进行处理与分析，能够突出要观察的部分。例如利用影像对病变体进行三维重建，可以帮助医生准确地确定病变体的大小、形状及与周围组织之间的空间关系。这样医生可以对病人的影像数据进行多方位、多层次的观察，使得在全面了解病人信息的情况下做出客观的诊断，减少主观判断带来的影响。对医学影像进行处理与分析可以为医生的诊断提供更有利的依据，提高诊断的准确性。因此，医学影像的处理分析和可视化对医学诊断具非常重要的意义。

对于医学图像处理与分析，算法是其发展的主要动力。目前，上面提到的三种医学图像处理与分析技术已经有了很多成熟的算法，并且新的算法还在不断涌现。除了在算法理论上的很多研究以外，在算法支撑基础上的软件平台的开发能更好地利用现有的算法，避免重复的劳动。这些软件平台不仅封装了他们自己的算法，还封装了很多成熟的算法，这使得医学影像领域的研究者与应用者可以很方便地在这些平台上实现和验证自己的算法，并且可以直接利用一些已经很成熟的算法，这样就大大缩短了研究成果和实际应用之间的距离。

在国际上，人们非常重视医学图像处理与分析平台的研发。Medical Image Computing & Computer Assisted Intervention(MICCAI)2003会议就医学影像领域的软件平台的设计问题开设了专门的研讨会。在2004年，Medical Image Analysis杂志专门提出了一个主题为Segmentation and Registration using ITK的Special Issue。在SPIE Medical Imaging的2006、2007年会议上开设了专门的course，称为Medical Image Analysis with ITK and Related Open-Source Software，探讨如何充分利用现有软件平台来实现对医学图像的处理和分析。当今，医学图像处理与分析软件平台的设计与实现已经成为医学影像领域的一个研究热点，世界上很多国家的研究机构、大学和著名公司正致力于医学影像处理软件的研发工作，并取得了相应的成果。

1.2医学图像处理与分析平台的国内外研究简介
可以将现有的国内外医学图像处理与分析软件平台概括地分为两类：一种是封装了各种医学图像处理与分析算法的平台，其为医学影像软件的开发提供了丰富的算法库；另一种是封装了各种医学图像处理与分析功能，并且具有友好界面的应用平台，其为科学研究和临床诊断等提供了强大的计算机辅助工具。

下面将首先介绍医学图像处理与分析算法ITK(Insight Segmentation and Registration Toolkit)和VTK(Visualization Toolkit)，它们是目前医学影像研究人员使用最广泛的两个算法平台。其次再介绍一些国内外优秀的医学影像处理与分析平台。

1.2.1可视化算法平台VTK
VTK最早在1993年12月由美国GE公司研发部门的Schroeder、Martin和Lorensen首次发布，当初是作为“The Visualization Toolkit: An Object-Oriented Approach to 3D Graphics ”这本书的配套软件。VTK是一个开放源代码的用于数据可视化的算法平台，目前由美国Kitware公司负责维护。VTK是在面向对象原理的基础上设计和实现的，它的内核是用C++构建的，包含大约250，000行代码，650多个类，还包含有几个转换界面，因此也可以自由的通过Java，TK和python各种语言使用VTK。同时，VTK支持跨平台开发，可以运行在Windows、Unix和Linux等多种平台下。虽然VTK并不是专门针对医学影像领域开发的算法平台，但是由于VTK里面提供了表面绘制、体绘制、一部分数字几何处理算法，这些都对医学影像领域内的研究有很大帮助，使它在医学影像领域得到了相当广泛的应用，发展到现在，VTK的稳定版本已经发行到5.1版本，并且新的版本还在不断持续开发中。

1.2.2分割与配准算法平台ITK
ITK是美国国家卫生院下属的国立医学图书馆发起并资助开发的一款医学图像处理软件包，其主要目的是提供一个医学影像分割和配准的算法平台。ITK大量使用了1988年以后的ANSI C++标准里的新特性，尤其是模板，并且ITK整个就是基于范型编程的设计思想来设计和实现的。ITK同时支持多种平台，可以在Windows、Unix、Linux等多种平台上运行。ITK也是一款免费开源软件，提供了几乎所有的主流的医学图像分割与配准算法。从1990年10月开始，到2002年10月，ITK已经完成了第一个3年计划，并成功发行了ITK1.0 。经过这么多年的发展，目前ITK的稳定版本已经发行到4.3，并且现在还一直在持续地发展，它已经并且将继续为医学影像领域内的研究人员提供一个分割与配准算法的创库和基础。

1.2.33DVIEWNIX系统
  由美国宾州大学放射系医学图像处理小组开发的3DVIEWNIX系统，是一款使用C语言在Unix下开发的，能够进行医学图像预处理、二维和三维可视化、图像分析等操作。3DVIEWNIX的特色之处在于提供了很多图像分割工具，包括阈值分割、基于模糊连接度的分割Livewire分割等等；数据采用多维泛化的ACR-NEMA标准；能够处理刚性、非刚性、静态和动态物体及其组件。3DVIEWNIX早在20世纪80年代就已经被开发，经过这么多年的发展和完善，已经是一款相当知名的系统。但是该应用平台是一款收费软件，即使对于科研和教学目的也不例外，另外加上其只能在Unix环境下运行，同时用户界面比较复杂，大大限制了其应用范围。

1.2.4MIMICS系统
MIMICS是由比利时的Materialise公司开发的交互式医学影像控制系统，即为Materialise’s interactive medical image control system，它是模块化结构的软件，可根据用户的不同需求进行不同的搭配。MIMICS是一套高度整合而且易用的3D图像生成及编辑处理软件，它能输入各种扫描的数据（CT，MRI和显微镜数据），建立3D模型进行编辑，然后输出通用的CAD（计算机的辅助设计）、FEA（有限元分析）和RP（快速成型）格式，可以直接在PC机上进行大规模数据的转换。MIMICS可以用于诊断，手术计划和演习，利用MIMICS进行数据分析，计划并仿真手术过程，预览手术的成果并作出接近于真实手术的决定，这些对于一个外科医生在走进手术室之前，不仅摆脱了做出多个手术决策的困扰，而且节省了大量的时间和财力。

1.2.5MITK & 3DMed平台
MITK是由中国科学院自动化研究所的医学影像研究组开发的集成化的医学影像处理与分析C++类库。MITK从一开始设计就始终追求统一、目标集中、方便移植和代码优化等几个高层的设计目标。MITK克服了VTK和ITK编程风格不同的问题，给需要结合ＶＴＫ和ＩＴＫ的使用者带来了很大方便，其为医学影像领域提供了一套整合了医学图像分割、配准和可视化等功能，其具有一致接口、可复用和灵活高效等优点。

3DMed是建立在MITK之上的医学图像处理分析平台，3DMed将应用层和算法层分离，提高了整个平台的研发效率。同时3DMed的内核提供了对Plugin的支持，研究者可以通过Plugin SDK；来设计新功能，从而能更方便地扩展3DMed平台。比较遗憾的是该系统不支持目前国际医学影像、放射界非常关注的磁共振扩散加权成像（Diffusion Weighted Imaging，DWI）和磁共振扩散张量成像（Diffusion Tensor Imaging，DTI）的分析、处理和体视化。尤其是作为最新磁共振影像技术的磁共振扩散张量成像，国内迄今尚未有开展支持这项技术平台研究的报道。

1.33D slicer系统
3D Slicer（以下简称Slicer） 是一款开源、免费和可扩展的医学图像处理和可视化的医学图像处理和分析应用平台，起源于1998年波士顿布里格姆妇女医院手术计划实验室和麻省理工学院的人工智能实验室联合发起的一个硕士论文项目，其目的在于开发一个易于使用的分析和可视化的软件。David Gering依据早期的研究小组在麻省理工学院和波士顿布里格姆妇女医院手术计划实验室的经验，于1999年在他的硕士毕业论文中首先提出Slicer的原型。随后，Steve Pieper担当Slicer的首席架构师，使Slicer的开发工作商业化以达到工业级别的安装包的要求。从1999年以来Slicer的开发一直受到Ron Kikinis领导的手术计划实验室的关注。如今Slicer的开发工作大部分都是由专业的工程师、算法开发人员和应用领域的科学家一起合作完成的，其间又有Isomics公司、Kitware公司和GE全球研究院等公司加入Slicer的开发中来，同时不断壮大的Slicer社区也对其发展也产生了巨大贡献。开发Slicer的最初设想是用于神经外科手术引导治疗、可视化和分析的系统，但是经过十几年的发展，Slicer已经成为一种不仅能够应用于各种临床和临床前的研究应用，还能够用于非医疗图像分析的综合平台。Slicer的开发和维护主要受到美国国家卫生研究院的资助，与此同时，Slicer也受益于其庞大的开发者社区，社区中的各种团队和个人使用者通过报告使用Slicer时遇到的软件问题、提出问题解决方案和开发新工具等来不断完善和拓展Slicer的功能。

Slicer的主要特征有广泛的功能、扩展性好、平台独立和无限制的软件许可等，这些特征正是其他同Slicer功能相似的商业和开源软件工具或工作站无法比拟的。由于商用影响工作站和图像分析工具通常不能被终端用户扩展其功能，开发模型也不是以接受新工具为导向的，可能还需要专门的硬件设备，使得他们在需要开发新的图像分析方法的工程中的应用受到很大限制。同时现有的很多商用影像工作站和图像分析工具的价格通常非常昂贵，不是所有的学术研究者都能买得起这些系统。和这些商用工作站相比， Slicer为学术研究者们提供免费的研究平台并且不需要专门的硬件设备，此外Slicer还支持多操作系统，如Windows，Mac OS X和Linux。

Slicer的最近一次发布的重要版本是2011年5月的Slicer 4，从2011年5月至今也发布了若干个稳定版本，现在最新的稳定版本是2012年11月发布的Slicer 4.2。
___

1.4本书主要内容
[1] 唐泽圣 三维数据场可视化[M].北京：清华大学出版社，1999.
[2] Nieolas J. Dusaussay, Robert N. Yaneey et al. Image Process FOR CT-Assisted Reverse Engineer and Part Charaeterization[J].IEEE, vol. 4, no.2, 2002
[3] http://www.analyzedirect.com/Analyze/
[4] http://www.mitk.net/
[5]李恩中. 医学图像处理与分析软件平台综述